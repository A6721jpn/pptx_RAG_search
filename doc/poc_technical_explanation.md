# PPTX/PDF AI検索システム (PoC) 技術解説書

このドキュメントでは、本Proof of Concept (PoC) で構築した「ドキュメント検索システム」の仕組みと処理の流れについて、専門用語を噛み砕いて解説します。

## 1. システムの概要

このシステムは、大量のPowerPointファイル（.pptx）やPDFファイルの中から、ユーザーの質問に関連するページをAI（人工知能）を使って探し出す検索エンジンです。

通常の「キーワード検索」とは異なり、**「意味検索（ベクトル検索）」** という技術を使っているのが最大の特徴です。これにより、「言葉が完全一致しなくても、意味が近いものを探す」ことができます。
（例：「PCの調子が悪い」で検索しても、「トラブルシューティング」や「故障」と書かれたページがヒットするなど）

この仕組みは、最近話題の **RAG (Retrieval-Augmented Generation)** という、「AIに社内データを参照させて回答させる技術」の「検索（Retrieval）」部分にあたります。

---

## 2. 処理の流れ：データの登録 (Ingestion)

ファイル検索できるようになるまでに、システムは裏側で以下の処理を行っています。これを「インジェスチョン（取り込み）」と呼びます。

### ステップ 1: テキストと画像の抽出
まず、フォルダ内のPPTXやPDFファイルを一つずつ読み込みます。
*   **テキスト抽出**: スライドやページの中に書かれている「文字」をすべて抜き出します。
*   **画像化**: 各ページを「画像（スクリーンショット）」として保存します。これは検索結果としてユーザーに表示するために使います。

### ステップ 2: ベクトル化 (Embedding)
ここがAIの肝となる部分です。抽出したテキストを、AIモデル（埋め込みモデル）に通して、**「ベクトル」** という数値の列に変換します。

*   **ベクトルとは？**:
    *   テキストの「意味」を、数百個〜数千個の数字の並び（座標）で表したものです。
    *   例えば、「犬」と「ワンちゃん」は文字は違いますが、意味が近いため、近い数字の並びになります。「犬」と「冷蔵庫」は遠い数字になります。
    *   このシステムでは、1ページ分のテキストを **768次元**（768個の数字のセット）のベクトルに変換しています。

### ステップ 3: データベースへの保存
変換された「ベクトル」と、元の「ドキュメント情報（ファイル名、ページ番号、画像パス）」をセットにして、**ベクトルデータベース (Qdrant)** に保存します。
普通のデータベースが「文字」を保存するのに対し、ベクトルデータベースは「意味の座標」を効率よく保存・検索することに特化しています。

---

## 3. 処理の流れ：検索 (Search)

ユーザーが質問をしてから、結果が出るまでの流れです。

### ステップ 1: 質問のベクトル化
ユーザーが入力した検索キーワード（例：「タッチパッドの仕様」）を、データ登録時と同じAIモデルを使ってベクトル（数値の列）に変換します。
これにより、質問文も「意味の座標」になります。

### ステップ 2: 類似度の計算
質問のベクトルと、データベースに保存されている全ページのベクトルを比較します。
ここで計算するのは物理的な「距離」ではなく、**「類似度（内積やコサイン類似度）」** です。

*   **イメージ**:
    *   ベクトルを「矢印」だと想像してください。
    *   質問の矢印と、ページの矢印が **「どれくらい同じ方向を向いているか」** を計算します。
    *   完全に一致すればスコアは高く（1.0に近く）、無関係なら低くなります。

### ステップ 3: ランキングと表示
スコアが高い（＝意味が最も近い）順に上位数件（デフォルトでは5件）をピックアップします。
そして、そのページの「画像」と「ファイル名」をユーザーに提示します。

これにより、ユーザーは質問の意図に最も合致した資料を瞬時に見つけることができます。

---

## 4. 用語集

| 用語                        | 解説                                                                                                                                             |
| :-------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------- |
| **RAG (ラグ)**              | Retrieval-Augmented Generationの略。AIに外部知識（社内文書など）を検索・参照させて、回答の精度を高める技術。本システムはその「検索」部分を担当。 |
| **ベクトル (Vector)**       | 言葉の意味を数値化したもの。多次元空間上の「点」や「矢印」として扱われる。                                                                       |
| **埋め込み (Embedding)**    | テキストをベクトルに変換する処理、またはその変換を担当するAIモデルのこと。                                                                       |
| **チャンク (Chunk)**        | 長い文章を処理しやすいサイズに分割した「かたまり」。本システムでは基本的に「1ページ」を1つのチャンクとして扱っています。                         |
| **Qdrant (キュードラント)** | ベクトルデータの保存・検索に特化したオープンソースのデータベースエンジン。                                                                       |
